/*! (C) WebReflection Mit Style License */
define(function(){function A(n){for(var r=[],i=[],l={5:function(e,t,n){return(t.length?r.push(s,t,n+f):r.push(n+f))&&s},10:function(e,t,n){return i.push(n.replace(b[t],"")+f)&&o}},c=0;c<N.length;c++)n=n.replace(N[c],C[c]||l[c]);return n.replace(u,function(n){return n=r.shift(),f+(n===s?e+' class="'+r.shift()+'">'+r.shift():e+">"+n)+t+f}).replace(a,function(n){return f+e+">"+i.shift()+t+f})}for(var e="<pre><code",t="</code></pre>",n="blockquote>",r="```",i="",s="\0",o="",u=/\x00/g,a=/\x01/g,f="\n",l="\\r\\n|\\r|\\n",c="(?:^|"+l+")",h="(?:$|"+l+")",p="(?:"+l+"(?!\\1)|$)",d="([^\\x00]*?)",v="\\[(.*?)\\]\\((.+?)(?: (&(?:quot|apos);)?(.+?)(\\3))?\\)",m="(.+?)"+h,g="g",y=g+"m",b={"	":/^\t/gm,"    ":/^    /gm,"&gt; ":/^&gt; /gm},w=/^#+$/,E=/^\d/,S=/  +/g,x=new RegExp("(?:^"+l+")",y),T=["&(?!#?[a-z0-9]+;)",g,"<",g,">",g,'"',g,"'",g,c+r+"([a-zA-Z]*)(?:"+l+")"+d+"(?:"+l+")"+r+h,g,"^"+m+"=+"+h,y,"^"+m+"-+"+h,y,"^(?:\\* \\* |- - |\\*\\*|--)[-*][-* ]*"+h,y,c+"( *)(\\* |\\+ |- |\\d+. )"+d+"(?="+l+"(?!\\1  )|$)",g,c+"(\\t| {4})"+d+p,g,"(`{1,2})([^\\r\\n]+?)\\1",y,"^(#{1,6})\\s+"+m,y,"  +"+h,g,"([_*]{1,2})([^\\2]+?)(\\1)",g,"!?"+v,y,c+"(&gt; )"+d+p,g],N=[],C=["&amp;","&lt;","&gt;","&quot;","&apos;",null,"<h1>$1</h1>","<h2>$1</h2>","<hr/>"+f,function(e,t,n,r,s,o){return k="<li>"+A(r.replace(S,"")).replace(x,"<br/>"+f)+"</li>"+f,s===0?(i=E.test(n)?"<ol>":"<ul>",k=i+f+k):o.length-(s+e.length)<2&&(k+=i.replace("<","</")),k},null,"<code>$2</code>",function(e,t,n,r){return"<h"+(r=t.length)+">"+n.replace(w,"")+"</h"+r+">"},"<br/>"+f,function(e,t,n,r){return"<"+(r=t.length==2?"strong>":"em>")+n+"</"+r},function(e,t,n,r,i){return e.charAt(0)==="!"?'<img src="'+n+'" alt="'+t+'" title="'+i+'"/>':'<a href="'+n+'" title="'+i+'">'+t+"</a>"},function(e,t,r){return"<"+n+A(r.replace(b[t],""))+"</"+n}],k,L=0;L<T.length;N.push(new RegExp(T[L++],T[L++])));return A});