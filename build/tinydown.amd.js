/*! (C) WebReflection Mit Style License */
define(function(){function H(e,t){return t=A.call(t),t.length?t.charAt(0)==="<"?t:"<p>"+t+"</p>":""}function B(r){for(var i=[],u=[],d=[],v={5:function(e,t,n){return(t.length?i.push(s,t,n+p):i.push(n+p))&&s},10:function(e,t,n){return u.push(n.replace(x[t],"")+p)&&o},16:function(e,t,r){return d.push(A.call(r.charAt(0)+r.slice(1).replace(x[t],""))),a}},m=0;m<M.length;m++)r=r.replace(M[m],_[m]||v[m]);return r.replace(f,function(n){return n=i.shift(),(n===s?e+' class="'+i.shift()+'">'+i.shift():e+">"+n)+t}).replace(l,function(n){return e+">"+u.shift()+t}).replace(c,H).replace(h,function(){return"<"+n+B(d.shift())+"</"+n})}for(var e="<pre><code",t="</code></pre>",n="blockquote>",r="```",i="",s="\0",o="",u="",a="<blockquote/>",f=/\x00/g,l=/\x01/g,c=/\x02([^\x00]*?)\x02/g,h=/<blockquote\/>/g,p="\n",d="\\r\\n|\\r|\\n",v="(?:^|"+d+")",m="(?:$|"+d+")",g="(?="+d+"(?!\\1)|$)",y="([^\\x00]*?)",b="\\[(.*?)\\]\\((.+?)(?: (&(?:quot|apos);)?(.+?)(\\3))?\\)",w="(.+?)"+m,E="g",S=E+"m",x={"	":/^\t/gm,"    ":/^    /gm,"&gt; ":/^&gt; /gm},T=/^#+$/,N=/^\s+|\s+$/g,C=/^\d/,k=/  +/g,L=new RegExp("(?:^"+d+")",S),A="".trim||function(){return this.replace(N,"")},O=["&(?!#?[a-z0-9]+;)",E,"<",E,">",E,'"',E,"'",E,v+r+"([a-zA-Z]*)(?:"+d+")"+y+"(?:"+d+")"+r+m,E,"^"+w+"=+"+m,S,"^"+w+"-+"+m,S,"^(?:\\* \\* |- - |\\*\\*|--)[-*][-* ]*"+m,S,v+"( *)(\\* |\\+ |- |\\d+. )"+y+"(?="+d+"(?!\\1  )|$)",E,v+"(\\t| {4})"+y+g,E,"(`{1,2})([^\\r\\n]+?)\\1",S,"^(#{1,6})\\s+"+w,S,"  +"+p,E,"([_*]{1,2})([^\\2]+?)(\\1)",E,"!?"+b,S,v+"(&gt; )"+y+g,E,v+"(?!<)([^\\x00]*?)(?="+m+"{2,})",E],M=[],_=["&amp;","&lt;","&gt;","&quot;","&apos;",null,"<h1>$1</h1>","<h2>$1</h2>","<hr/>",function(e,t,n,r,s,o){return D="<li>"+B(r.replace(k,"")).replace(L,"<br/>")+"</li>",s===0?(i=C.test(n)?"<ol>":"<ul>",D=i+D):o.length-(s+e.length)<2&&(D+=i.replace("<","</")),D},null,"<code>$2</code>",function(e,t,n,r){return"<h"+(r=t.length)+">"+n.replace(T,"")+"</h"+r+">"},"<br/>",function(e,t,n,r){return"<"+(r=t.length==2?"strong>":"em>")+n+"</"+r},function(e,t,n,r,i){return e.charAt(0)==="!"?'<img src="'+n+'" alt="'+t+'" title="'+i+'"/>':'<a href="'+n+'" title="'+i+'">'+t+"</a>"},null,u+"$1"+u],D,P=0;P<O.length;M.push(new RegExp(O[P++],O[P++])));return B});